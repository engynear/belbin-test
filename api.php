<?php

$json = file_get_contents('php://input');
$data = json_decode($json);

function sender($name, $email){
    $subject = '–ß–µ–∫-–ª–∏—Å—Ç "–¢–µ—Å—Ç –ë–µ–ª–±–∏–Ω–∞"';

    $msg = '
        <html>
            <head>
                <title>–ß–µ–∫-–ª–∏—Å—Ç "–¢–µ—Å—Ç –ë–µ–ª–±–∏–Ω–∞"</title>
            </head>
            <body>
                <p>–ü—Ä–∏–≤–µ—Ç!</p>
                <p>
                    –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –º—ã –≤–∏–¥–µ–ª–∏—Å—å —Å —Ç–æ–±–æ–π, –∫–æ–≥–¥–∞ —Ç—ã –ø—Ä–æ—Ö–æ–¥–∏–ª —Ç–µ—Å—Ç –ë–µ–ª–±–∏–Ω–∞. –Ø –æ–±–µ—â–∞–ª —Ç–µ–±–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª–µ–∑–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–∫–∞–∑–∞–Ω–æ –æ –∫–∞–∂–¥–æ–π —Ä–æ–ª–∏: –æ—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç–µ–ª—è –¥–æ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–∏—Å—Ç–∞.
				</p><p>
                    –õ–æ–≤–∏ —Å–≤–æ—é –¥–æ–∑—É –ø–æ–ª—å–∑—ã –∏ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:
                    <a href="http://incube.world/test-belbina/belbina.pdf">–ß–µ–∫-–ª–∏—Å—Ç —Ç–µ—Å—Ç–∞ –ë–µ–ª–∏–Ω–∞</a>
                </p><p>
                    –ú—ã —Å –∫–æ–º–∞–Ω–¥–æ–π —É–≤–µ—Ä–µ–Ω—ã, —Ç—ã —Å–º–æ–∂–µ—à—å –±—ã—Å—Ç—Ä–æ –≤–Ω–µ–¥—Ä–∏—Ç—å –≤ —Ä–∞–±–æ—Ç—É –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –∏ —Å—Ç–∞—Ç—å –ª—É—á—à–∏–º —Å–ø–µ—Ü–æ–º –¥–ª—è —Å–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞!
                    –î–µ–ª–∏—Å—å —Å–≤–æ–∏–º–∏ –∏–Ω—Å–∞–π—Ç–∞–º–∏ –≤ –∏–Ω—Å—Ç–∞–≥—Ä–∞–º –∏ –æ—Ç–º–µ—á–∞–π –º–µ–Ω—è @yanpalm üöÄüî•
                </p>
            </body>
        </html>
    ';


    // –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ HTML-–ø–∏—Å—å–º–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ Content-type
    $headers[]  = 'MIME-Version: 1.0';
    $headers[] = 'Content-type: text/html; charset=utf-8';

    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
    $headers[] = "To: ".$name." <".$email.">";
    $headers[] = 'From: info@incube.word';
    $headers[] = "Reply-To: no-replay";

    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º
    mail($email, $subject, $msg, implode("\r\n", $headers));
}
$action = $data -> {'action'};
switch ($action) {
    case 'mail':
        $name = $data -> {'name'};
        $email = $data -> {'email'};

        sender($name, $email);
        echo '{"result": "ok"}';
        break;
    case 'sheet':
        echo '{"result": "ok"}';
        break;
    default:
        echo '{"error": "Bad request"}';
}